---
layout: single
title:  "ポートフォリオ配分の平均分散分析理論"
date:   2020-07-24 16:31:00 +0900
categories: math economics
---
金融資産ポートフォリオの配分を考えるとき、金融資産の期待リターン(平均)とリスク(分散)に着目して配分の最適化を行うことを、平均分散分析と呼びます。
ノーベル経済学賞のハリー・マーコウィッツによって理論化され、CAPM(Capital Asset Pricing Model:資本資産価格モデル)といった現代的なポートフォリオ理論の基礎となっています。
今回は、平均分散分析の数学的な定式化の部分について、基礎的なところからフォローしていこうと思います。

【導入】
まず、あるポートフォリオを構成する金融資産が\\(n\\)個あるとして、\\(i\\)番目の金融資産のリターンを\\(R_i \ (i=1,2,...,n)\\)とします。
また、金融資産の配分を\\(w_i\\)とします(各資産を何パーセントずつ持つか、という値です)。そうすると、このポートフォリオのリターン\\(R_{\rm p}\\)は
\begin{equation}
    R_{\rm p} = \sum_{i=1}^{n} w_i R_i
\end{equation}
となります。全体を100%(=1)とするために、
\begin{equation}
    \sum_{i=1}^{n} w_i = 1 \label{constraint1}
\end{equation}
という条件が付きます。
投資家がポートフォリオを構成するときには、この配分\\(w_i\\)を自由に決めることができ、これを決めることがまさに投資の戦略ということになります。

投資家の目標は、ポートフォリオのリターン\\(R_{\rm p}\\)(=全体の儲け)を最大化するように配分\\(w_i\\)を決めることです。
ここまでの条件でこの目標を達成することは簡単で、\\(R_i\\)が最も大きい資産\\(i\\)にすべて投資すればいいことになります。
しかし、実際にはリターン\\(R_i\\)は正確にはわかりません。それが最初からわかってしまえば、最も儲かるものに全投資、というポートフォリオ構成も何もない上記のような選択をすればいいだけ、となってしまいますが、実際にはあり得ません。

そこで、リターン\\(R_i\\)は「確率的に分布する」と仮定します。そして、ポートフォリオのリターンの平均
\begin{equation}
    E(R_{\rm p}) = \sum_{i=1}^{n} w_i E(R_i) \label{expect}
\end{equation}
を考えます。これを期待リターンと呼びます。投資家は、リターンの代わりにこの期待リターンを最大化したいと考えます。
次に、ポートフォリオのリターンの分散\\(V(R_{\rm p})\\)をリスクと呼びます。これは、リターンがどれだけ変動し得るかを示す値になります。投資家は、このリスクを最小化したいと考えます。

分散\\(V(R_{\rm p})\\)は、
\begin{align}
    V(R_{\rm p}) &= V(\sum_{i=1}^{n} w_i R_i) \\\ 
    &= \sum_{i,j=1}^{n} w_i w_j {\rm Cov}(R_i,R_j) \label{var}
\end{align}
となります。ここで、\\({\rm Cov}(R_i,R_j)\\)は共分散です。

従って、\eqref{constraint1}と\eqref{expect}を束縛条件として、\eqref{var}を最小化するという問題になります。
行列で表記すると、\\(w = [w_1, w_2, \ldots, w_n]^T\\)
\begin{align}
    制約条件
    &: Aw = b \\\
    &: w \geq 0 \\\
    最小化 &: w^T \Sigma w
\end{align}
となります。ここで、
\begin{align}
A &= \left[ \array{
    1 & 1 & \cdots & 1\\\
    E(R_1) & E(R_2) & \cdots & E(R_n)
} \right] \\\
b &= [1, E(R_{\rm p})]^T \\\
\end{align}
また、
\begin{equation}
\Sigma = \left[ \array{
    V(R_1) & {\rm Cov} (R_1, R_2) & \cdots & {\rm Cov} (R_1, R_n) \\\
    {\rm Cov} (R_2, R_1) & V(R_2) & \cdots & {\rm Cov} (R_2, R_n) \\\
    \vdots & \vdots & \ddots & \vdots \\\
    {\rm Cov} (R_n, R_1) & {\rm Cov} (R_n, R_2) & \cdots & V(R_n)\\\
} \right]
\end{equation}
です。(続く)